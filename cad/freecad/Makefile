# $FreeBSD$

PORTNAME=	freecad
PORTVERSION=	0.16
CATEGORIES=	cad

MAINTAINER=	tj+freebsd_ports@a13.fr
COMMENT=	An open-source parametric 3D CAD modeler

LICENSE=	LGPL20+

BUILD_DEPENDS=	python:lang/python \
		pyside-uic:devel/pyside-tools \
		eigen>0:math/eigen3
LIB_DEPENDS=	libboost_python.so:devel/boost-python-libs \
		libxerces-c.so:textproc/xerces-c3 \
		libTKernel.so:cad/opencascade \
		libCoin.so:graphics/Coin \
		libshiboken-${PYTHON_VERSION}.so:devel/shiboken

USES=		cmake python
USE_GITHUB=	yes
USE_QT4=	qmake_build moc_build rcc_build uic_build \
		webkit
GH_ACCOUNT=	FreeCAD
GH_PROJECT=	FreeCAD
CMAKE_ARGS=	-DCMAKE_BUILD_TYPE:STRING=Release \
		-DOCC_INCLUDE_DIR:PATH=${LOCALBASE}/include/OpenCASCADE \
		-DCMAKE_INSTALL_DATADIR=${DATADIR} \
		-DCMAKE_INSTALL_LIBDIR=${LOCALBASE}/lib/freecad

NO_OPTIONS_SORT=	yes
OPTIONS_DEFINE=	\
	FEM \
	SANDBOX \
	TEMPLATE \
	ARCH \
	ASSEMBLY \
	COMPLETE \
	DRAFT \
	DRAWING \
	IDF \
	IMAGE \
	IMPORT \
	INSPECTION \
	JTREADER \
	MATERIAL \
	MESH \
	MESH_PART \
	OPENSCAD \
	PART \
	PART_DESIGN \
	PATH \
	PLOT \
	POINTS \
	RAYTRACING \
	REVERSEENGINEERING \
	ROBOT \
	SHIP \
	SKETCHER \
	SPREADSHEET \
	START \
	TEST \
	WEB \
	VR

OPTIONS_DEFAULT=	FEM ARCH COMPLETE DRAFT DRAWING IDF IMAGE IMPORT \
			INSPECTION MATERIAL MESH MESH_PART OPENSCAD PART \
			PART_DESIGN PATH PLOT POINTS RAYTRACING \
			REVERSEENGINEERING SHIP SKETCHER SPREADSHEET \
			START TEST WEB

FEM_DESC=		Build the FreeCAD FEM module, be aware, unfinished code!
FEM_CMAKE_ON=		-DBUILD_FEM:BOOL=TRUE
FEM_CMAKE_OFF=		-DBUILD_FEM:BOOL=FALSE

SANDBOX_DESC=		Build the FreeCAD Sandbox module which is only for testing purposes
SANDBOX_CMAKE_ON=	-DBUILD_SANDBOX:BOOL=TRUE
SANDBOX_CMAKE_OFF=	-DBUILD_SANDBOX:BOOL=FALSE

TEMPLATE_DESC=		Build the FreeCAD template module which is only for testing purposes
TEMPLATE_CMAKE_ON=	-DBUILD_TEMPLATE:BOOL=TRUE
TEMPLATE_CMAKE_OFF=	-DBUILD_TEMPLATE:BOOL=FALSE

ARCH_DESC=		Build the FreeCAD Architecture module
ARCH_CMAKE_ON=		-DBUILD_ARCH:BOOL=TRUE \
			-DFREECAD_USE_EXTERNAL_PIVY:BOOL=TRUE
ARCH_CMAKE_OFF=		-DBUILD_ARCH:BOOL=FALSE
ARCH_RUN_DEPENDS=	pyside-uic:devel/pyside-tools \
			pivy>0:graphics/py-pivy

ASSEMBLY_DESC=		Build the FreeCAD Assembly module
ASSEMBLY_CMAKE_ON=	-DBUILD_ASSEMBLY:BOOL=TRUE
ASSEMBLY_CMAKE_OFF=	-DBUILD_ASSEMBLY:BOOL=FALSE

COMPLETE_DESC=		Build the FreeCAD complete module
COMPLETE_CMAKE_ON=	-DBUILD_COMPLETE:BOOL=TRUE
COMPLETE_CMAKE_OFF=	-DBUILD_COMPLETE:BOOL=FALSE

DRAFT_DESC=		Build the FreeCAD draft module
DRAFT_CMAKE_ON=		-DBUILD_DRAFT:BOOL=TRUE \
			-DFREECAD_USE_EXTERNAL_PIVY:BOOL=TRUE
DRAFT_CMAKE_OFF=	-DBUILD_DRAFT:BOOL=FALSE
DRAFT_RUN_DEPENDS=	pyside-uic:devel/pyside-tools \
			pivy>0:graphics/py-pivy

DRAWING_DESC=		Build the FreeCAD drawing module
DRAWING_CMAKE_ON=	-DBUILD_DRAWING:BOOL=TRUE
DRAWING_CMAKE_OFF=	-DBUILD_DRAWING:BOOL=FALSE

IDF_DESC=		Build the FreeCAD idf module
IDF_CMAKE_ON=		-DBUILD_IDF:BOOL=TRUE
IDF_CMAKE_OFF=		-DBUILD_IDF:BOOL=FALSE

IMAGE_DESC=		Build the FreeCAD image module
IMAGE_CMAKE_ON=		-DBUILD_IMAGE:BOOL=TRUE
IMAGE_CMAKE_OFF=	-DBUILD_IMAGE:BOOL=FALSE

IMPORT_DESC=		Build the FreeCAD import module
IMPORT_CMAKE_ON=	-DBUILD_IMPORT:BOOL=TRUE
IMPORT_CMAKE_OFF=	-DBUILD_IMPORT:BOOL=FALSE

INSPECTION_DESC=	Build the FreeCAD inspection module
INSPECTION_CMAKE_ON=	-DBUILD_INSPECTION:BOOL=TRUE
INSPECTION_CMAKE_OFF=	-DBUILD_INSPECTION:BOOL=FALSE

JTREADER_DESC=		Build the FreeCAD jt reader module
JTREADER_CMAKE_ON=	-DBUILD_JTREADER:BOOL=TRUE
JTREADER_CMAKE_OFF=	-DBUILD_JTREADER:BOOL=FALSE

MATERIAL_DESC=		Build the FreeCAD material module
MATERIAL_CMAKE_ON=	-DBUILD_MATERIAL:BOOL=TRUE
MATERIAL_CMAKE_OFF=	-DBUILD_MATERIAL:BOOL=FALSE

MESH_DESC=		Build the FreeCAD mesh module
MESH_CMAKE_ON=		-DBUILD_MESH:BOOL=TRUE
MESH_CMAKE_OFF=		-DBUILD_MESH:BOOL=FALSE

MESH_PART_DESC=		Build the FreeCAD mesh part module
MESH_PART_CMAKE_ON=	-DBUILD_MESH_PART:BOOL=TRUE
MESH_PART_CMAKE_OFF=	-DBUILD_MESH_PART:BOOL=FALSE

OPENSCAD_DESC=		Build the FreeCAD openscad module
OPENSCAD_CMAKE_ON=	-DBUILD_OPENSCAD:BOOL=TRUE
OPENSCAD_CMAKE_OFF=	-DBUILD_OPENSCAD:BOOL=FALSE
OPENSCAD_RUN_DEPENDS=	pyside-uic:devel/pyside-tools

PART_DESC=		Build the FreeCAD part module
PART_CMAKE_ON=		-DBUILD_PART:BOOL=TRUE
PART_CMAKE_OFF=		-DBUILD_PART:BOOL=FALSE

PART_DESIGN_DESC=	Build the FreeCAD part design module
PART_DESIGN_CMAKE_ON=	-DBUILD_PART_DESIGN:BOOL=TRUE
PART_DESIGN_CMAKE_OFF=	-DBUILD_PART_DESIGN:BOOL=FALSE

PATH_DESC=		Build the FreeCAD path module
PATH_CMAKE_ON=		-DBUILD_PATH:BOOL=TRUE
PATH_CMAKE_OFF=		-DBUILD_PATH:BOOL=FALSE

PLOT_DESC=		Build the FreeCAD plot module
PLOT_CMAKE_ON=		-DBUILD_PLOT:BOOL=TRUE
PLOT_CMAKE_OFF=		-DBUILD_PLOT:BOOL=FALSE
PLOT_RUN_DEPENDS=	pyside-uic:devel/pyside-tools

POINTS_DESC=		Build the FreeCAD points module
POINTS_CMAKE_ON=	-DBUILD_POINTS:BOOL=TRUE
POINTS_CMAKE_OFF=	-DBUILD_POINTS:BOOL=FALSE

RAYTRACING_DESC=	Build the FreeCAD ray tracing module
RAYTRACING_CMAKE_ON=	-DBUILD_RAYTRACING:BOOL=TRUE
RAYTRACING_CMAKE_OFF=	-DBUILD_RAYTRACING:BOOL=FALSE

REVERSEENGINEERING_DESC=	Build the FreeCAD reverse engineering module
REVERSEENGINEERING_CMAKE_ON=	-DBUILD_REVERSEENGINEERING:BOOL=TRUE
REVERSEENGINEERING_CMAKE_OFF=	-DBUILD_REVERSEENGINEERING:BOOL=FALSE

ROBOT_DESC=		Build the FreeCAD robot module
ROBOT_CMAKE_ON=		-DBUILD_ROBOT:BOOL=TRUE -DFREECAD_USE_EXTERNAL_KDL:BOOL=TRUE
ROBOT_CMAKE_OFF=	-DBUILD_ROBOT:BOOL=FALSE

SHIP_DESC=		Build the FreeCAD ship module
SHIP_CMAKE_ON=		-DBUILD_SHIP:BOOL=TRUE
SHIP_CMAKE_OFF=		-DBUILD_SHIP:BOOL=FALSE
SHIP_RUN_DEPENDS=	pyside-uic:devel/pyside-tools

SKETCHER_DESC=		Build the FreeCAD sketcher module
SKETCHER_CMAKE_ON=	-DBUILD_SKETCHER:BOOL=TRUE
SKETCHER_CMAKE_OFF=	-DBUILD_SKETCHER:BOOL=FALSE

SPREADSHEET_DESC=	Build the FreeCAD spreadsheet module
SPREADSHEET_CMAKE_ON=	-DBUILD_SPREADSHEET:BOOL=TRUE
SPREADSHEET_CMAKE_OFF=	-DBUILD_SPREADSHEET:BOOL=FALSE
SPREADSHEET_RUN_DEPENDS=	pyside-uic:devel/pyside-tools

START_DESC=		Build the FreeCAD start module
START_CMAKE_ON=		-DBUILD_START:BOOL=TRUE
START_CMAKE_OFF=	-DBUILD_START:BOOL=FALSE

TEST_DESC=		Build the FreeCAD test module
TEST_CMAKE_ON=		-DBUILD_TEST:BOOL=TRUE
TEST_CMAKE_OFF=		-DBUILD_TEST:BOOL=FALSE

WEB_DESC=		Build the FreeCAD web module
WEB_CMAKE_ON=		-DBUILD_WEB:BOOL=TRUE
WEB_CMAKE_OFF=		-DBUILD_WEB:BOOL=FALSE

VR_DESC=		Build the FreeCAD Oculus Rift support (need Oculus SDK 4.x or higher)
VR_CMAKE_ON=		-DBUILD_VR:BOOL=TRUE
VR_CMAKE_OFF=		-DBUILD_VR:BOOL=FALSE

.include <bsd.port.mk>
